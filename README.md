# illpro226.github.io
OpCode Web Site maker Site address
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>OpCode: Quantum UI ‚Äî Website Builder (v2.3.4)</title><style>:root{--bg:#0f1220;--panel:#151a2c;--ink:#ecf0ff;--muted:#9aa4c7;--accent:#7c5cff;--accent-2:#20c997;--danger:#ff5c7a;--radius:16px;--gap:14px;--shadow:0 12px 30px rgba(0,0,0,.35);--sel:#7c5cff66}*{box-sizing:border-box}html,body{height:100%}body{margin:0;background:radial-gradient(1200px 800px at 10% -10%,#1b2241,transparent),var(--bg);color:var(--ink);font:500 14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial}.app{display:grid;grid-template-columns:360px 1fr 360px;gap:var(--gap);height:100vh;padding:var(--gap)}.panel{background:linear-gradient(180deg,#171c30,#101426);border:1px solid rgba(255,255,255,.07);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}.sidebar,.inspector{display:flex;flex-direction:column}.sidebar{padding:16px;min-width:320px}.inspector{min-width:320px}.brand{display:flex;align-items:center;gap:10px;padding:12px 16px;border-bottom:1px solid #222845}.brand .logo{width:28px;height:28px;border-radius:8px;background:radial-gradient(8px 8px at 75% 25%,#fff6,transparent 60%),conic-gradient(from 200deg at 50% 50%,var(--accent),var(--accent-2));box-shadow:inset 0 0 0 2px #0003}.brand h1{font-size:16px;margin:0}.muted{color:var(--muted)}.toolrow{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0}button,select,input[type=color],input[type=file],.chip{background:#0e1325;color:var(--ink);border:1px solid #2a3256;border-radius:10px;padding:8px 10px;font:inherit;cursor:pointer}button:disabled{opacity:.5;cursor:default}.btn{background:linear-gradient(180deg,#1c2344,#141a34)}.btn.primary{background:linear-gradient(180deg,#6b51ff,#5b43ea);border-color:#7a64ff}.btn.ghost{background:#0e132500}.danger{background:linear-gradient(180deg,#ff6b8a,#fb5478);border-color:#ff7a9a}.divider{height:1px;background:linear-gradient(90deg,transparent,#2a3256,transparent);margin:12px 0}label{font-size:12px;color:var(--muted);display:block;margin:6px 0 4px}input[type=text],textarea,input[type=number],input[type=range]{width:100%;background:#0e1325;color:var(--ink);border:1px solid #2a3256;border-radius:10px;padding:8px 10px;font:inherit}.canvas{position:relative;overflow:auto}.viewport-bar{display:flex;gap:8px;align-items:center;padding:8px 10px;border-bottom:1px solid #222845;background:#121733}.viewport{display:grid;place-items:start center;height:calc(100% - 44px);overflow:auto;background:radial-gradient(600px 300px at 50% -10%,#0e1431,transparent)}.frame{background:#fff;color:#111;border-radius:12px;box-shadow:0 30px 60px rgba(0,0,0,.35);margin:24px auto;position:relative}.frame.w-desktop{width:1100px}.frame.w-tablet{width:820px}.frame.w-mobile{width:420px}.site .hero{padding:80px 40px;text-align:center;background:linear-gradient(180deg,var(--heroTop,#f5f7ff),var(--heroBottom,#eef2ff));position:relative;overflow:hidden}.site .brand-logo{display:block;margin:0 auto 16px auto;max-width:100%;height:auto;filter:drop-shadow(0 4px 12px rgba(0,0,0,.25))}.site .hero h1{margin:0 0 10px;font-size:42px}.site .hero p{margin:0 auto 22px;max-width:720px;color:#444;font-size:18px}.site .hero .cta{display:flex;gap:10px;justify-content:center}.site .hero .cta a{background:var(--color,#635bff);color:#fff;padding:12px 16px;border-radius:12px;text-decoration:none}.site .features{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));padding:40px}.site .card{background:#fff;border:1px solid #e9ecf6;border-radius:14px;padding:16px}.site .gallery{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));padding:40px}.site .gallery img{width:100%;height:160px;object-fit:cover;border-radius:12px;border:1px solid #e9ecf6}.site .footer{padding:24px 40px;border-top:1px solid #edf0ff;color:#333;background:#fafbff}.sec-wrap{position:relative}.sec-wrap.selected::after{content:"";position:absolute;inset:0;border:2px dashed var(--accent);border-radius:12px;background:var(--sel)}.sec-tools{position:absolute;top:8px;right:8px;display:flex;gap:6px;z-index:2}.sec-tools button{padding:6px 8px;border-radius:8px}.section-row{padding:8px;border:1px solid #2a3256;border-radius:10px;margin:6px 0;background:#0f152a;display:flex;align-items:center;gap:8px}.section-row.drag-over{outline:2px dashed var(--accent)}.rowtitle{flex:1}.preset-bar{display:flex;gap:8px;flex-wrap:wrap}.preset{padding:6px 10px;border-radius:999px;border:1px solid #2a3256;background:#0f152a;cursor:pointer}.inspector .inner{padding:12px}.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid #2a3256;background:#0f152a;text-decoration:none;color:#cdd6ff;font-size:12px}</style></head><body><div class="app"><aside class="panel sidebar"><div class="brand"><div class="logo"></div><h1>OpCode: Quantum UI</h1><span class="muted">Editor v2.3.4</span></div><div class="toolrow"><button class="btn primary" id="newSiteBtn">New</button><button class="btn" id="templatesBtn">Templates</button><button class="btn" id="exportBtn" disabled title="Ctrl/Cmd+S">Export</button></div><a class="badge" href="https://docs.github.com/en/pages" target="_blank" rel="noreferrer">GitHub Pages ‚Üó</a><div class="divider"></div><strong>Theme</strong><div class="toolrow preset-bar" id="themePresets"></div><div class="toolrow"><div style="flex:1"><label>Brand color</label><input type="color" id="colorPicker" value="#635bff"/></div><div><label>Hero top</label><input type="color" id="heroTop" value="#f5f7ff"/></div><div><label>Hero bottom</label><input type="color" id="heroBottom" value="#eef2ff"/></div></div><label>Font stack</label><select id="fontSelect"><option value="system-ui, -apple-system, Segoe UI, Roboto, Arial">System UI</option><option value="Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial">Inter (fallback)</option><option value="Georgia, 'Times New Roman', serif">Serif</option><option value="'Courier New', monospace">Monospace</option></select><div class="divider"></div><strong>Brand</strong><label>Logo URL</label><input type="text" id="logoUrl" placeholder="https://... or data:image/png;base64,..."/><div class="toolrow"><input type="file" id="logoFile" accept="image/*"/><div style="display:flex;align-items:center;gap:8px"><label style="margin:0">Width</label><input type="number" id="logoW" value="140" min="32" max="600" style="width:90px"/></div></div><div class="divider"></div><strong>Sections</strong><div id="sectionsList"></div><div class="toolrow"><select id="newSectionType"><option value="hero">Hero</option><option value="features">Features</option><option value="gallery">Gallery</option><option value="footer">Footer</option></select><button class="btn" id="addSectionBtn">Add</button></div><div class="divider"></div><strong>Deploy (GitHub Pages helper)</strong><label>GitHub username or org</label><input type="text" id="ghUser" placeholder="your-username"/><label>Repository name</label><input type="text" id="ghRepo" placeholder="opcode-site"/><div class="toolrow"><label style="display:flex;align-items:center;gap:8px"><input type="checkbox" id="ghPublic" checked/> Public repo</label><input type="text" id="ghDomain" placeholder="Custom domain (optional)"/></div><div class="toolrow"><button class="btn" id="copyYamlBtn" title="Copy workflow YAML">Copy YAML</button><button class="btn primary" id="copyScriptBtn" title="Copy PowerShell deploy script">Copy PS Script</button></div><div class="divider"></div><div class="chips"><span class="chip">Drag & drop</span><span class="chip">Inline edit</span><span class="chip">Undo/Redo</span><span class="chip">Responsive preview</span><span class="chip">Image uploads</span></div></aside><main class="panel canvas"><div class="viewport-bar"><strong style="padding-right:8px">Preview</strong><button class="btn" data-w="desktop">Desktop</button><button class="btn" data-w="tablet">Tablet</button><button class="btn" data-w="mobile">Mobile</button><span class="muted" style="margin-left:auto" id="status">(no site)</span></div><div class="viewport" id="viewport"><div id="frame" class="frame w-desktop"><div id="siteRoot" class="site" style="font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial"></div></div></div></main><aside class="panel inspector"><div class="brand"><h1 style="font-size:16px;margin:0">Inspector</h1><span class="muted" id="selLabel">Nothing selected</span></div><div class="inner" id="inspectorBody"><div class="muted">Select a section to edit its content and styles. Double‚Äëclick text on the canvas to edit inline.</div></div></aside></div><template id="tpl-hero-editor"><label>Headline</label><input type="text" data-bind="h1" placeholder="Your product, elevated"/><label>Subheading</label><textarea data-bind="p" placeholder="Short supporting copy explaining the value."></textarea><div class="toolrow"><input class="grow" type="text" data-bind="cta1" placeholder="Get started"/><input class="grow" type="text" data-bind="cta2" placeholder="Learn more"/></div><div class="divider"></div><strong>Background image</strong><label>Image URL</label><input type="text" data-bind="bgUrl" placeholder="https://... or data:image/..."/><div class="toolrow"><input type="file" data-bgfile accept="image/*"/><div><label>Fit</label><select data-bind="bgSize"><option value="cover">Cover</option><option value="contain">Contain</option></select></div><div style="display:flex;align-items:center;gap:8px"><label style="margin:0">Dark overlay</label><input type="number" data-bind="overlay" min="0" max="0.8" step="0.05" value="0.3" style="width:84px"/></div></div></template><template id="tpl-features-editor"><label>Feature cards (one per line, ‚Äú | ‚Äù between title and body)</label><textarea data-bind="items" placeholder="Fast setup | Spin up a site in minutes&#10;Beautiful themes | Pick a style and go&#10;Exporter | Download clean HTML"></textarea></template><template id="tpl-gallery-editor"><label>Image URLs (one per line)</label><textarea data-bind="images" placeholder="https://picsum.photos/600/400&#10;https://picsum.photos/601/400&#10;https://picsum.photos/602/400"></textarea></template><template id="tpl-footer-editor"><label>Footer text</label><input type="text" data-bind="text" placeholder="¬© 2025 Your Brand"/></template><dialog id="templatesDialog" style="max-width:760px;width:96%;border:none;border-radius:16px;padding:0;overflow:hidden;background:#0f152a;color:#ecf0ff"><div style="padding:16px 16px 0 16px;display:flex;align-items:center;gap:10px"><h3 style="margin:0">Templates</h3><button class="btn ghost right" id="closeTpl">Close</button></div><div style="padding:16px;display:grid;gap:12px"><div class="template-card" data-template="starter"><div class="template-thumb">Starter</div><div><div><strong>Starter landing</strong></div><div class="muted">Hero, three features, simple footer.</div></div></div><div class="template-card" data-template="portfolio"><div class="template-thumb">Portfolio</div><div><div><strong>Creator portfolio</strong></div><div class="muted">Hero with CTA, gallery, footer.</div></div></div><div class="template-card" data-template="restaurant"><div class="template-thumb">Restaurant</div><div><div><strong>Restaurant splash</strong></div><div class="muted">Hero, features (hours/location), gallery, footer.</div></div></div></div></dialog><script>const $=(s,r=document)=>r.querySelector(s),$$=(s,r=document)=>Array.from(r.querySelectorAll(s)),now=()=>new Date().toISOString();function escapeHTML(s){return String(s).replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]))}function escapeAttr(s){return String(s).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}const STORAGE={site:'opcode.quantumui.site',versions:'opcode.quantumui.versions'},LEGACY={site:'siteforge.mvp',versions:'siteforge.versions'};function migrateStorage(){let m=false;try{if(!localStorage.getItem(STORAGE.site)){const l=localStorage.getItem(LEGACY.site);if(l){localStorage.setItem(STORAGE.site,l);m=true}}if(!localStorage.getItem(STORAGE.versions)){const v=localStorage.getItem(LEGACY.versions);if(v){localStorage.setItem(STORAGE.versions,v);m=true}}if(m){localStorage.removeItem(LEGACY.site);localStorage.removeItem(LEGACY.versions)}}catch(e){}return m}const fileToDataURL=f=>new Promise((res,rej)=>{const r=new FileReader();r.onload=()=>res(r.result);r.onerror=rej;r.readAsDataURL(f)});const defaultSite=()=>({name:"Untitled site",theme:{color:"#635bff",heroTop:"#f5f7ff",heroBottom:"#eef2ff",font:"system-ui, -apple-system, Segoe UI, Roboto, Arial",logo:null,logoW:140},sections:[]});const templates={starter:()=>({name:"Starter Landing",theme:{color:"#635bff",heroTop:"#f5f7ff",heroBottom:"#eef2ff",font:"system-ui, -apple-system, Segoe UI, Roboto, Arial",logo:null,logoW:160},sections:[{type:"hero",data:{h1:"Launch faster with Quantum UI",p:"Pick a template, tweak content, and export a clean website.",cta1:"Get started",cta2:"See features",bgUrl:"",bgSize:"cover",overlay:.3}},{type:"features",data:{items:`No-build export | Download one HTML file\nClean markup | SEO-friendly structure\nThemeable | Change colors and font`}}, {type:"footer",data:{text:"¬© 2025 Your Brand"}}]}),portfolio:()=>({name:"Creator Portfolio",theme:{color:"#20c997",heroTop:"#f2fffb",heroBottom:"#e6fff7",font:"Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial",logo:null,logoW:140},sections:[{type:"hero",data:{h1:"Hi, I‚Äôm Alex ‚Äî designer & maker",p:"Selected work and experiments.",cta1:"Contact",cta2:"View work",bgUrl:"",bgSize:"cover",overlay:.25}},{type:"gallery",data:{images:["https://picsum.photos/seed/a/900/600","https://picsum.photos/seed/b/900/600","https://picsum.photos/seed/c/900/600","https://picsum.photos/seed/d/900/600"]}},{type:"footer",data:{text:"¬© 2025 Alex ‚Äî All rights reserved"}}]}),restaurant:()=>({name:"Cedar Grill",theme:{color:"#ff7a66",heroTop:"#fff7f5",heroBottom:"#fff0ec",font:"Georgia, 'Times New Roman', serif",logo:null,logoW:160},sections:[{type:"hero",data:{h1:"Cedar Grill",p:"Wood-fired kitchen. Open daily 11‚Äì9.",cta1:"View menu",cta2:"Reserve",bgUrl:"",bgSize:"cover",overlay:.2}},{type:"features",data:{items:`Location | 123 Main St, Roseburg\nHours | Daily 11am‚Äì9pm\nPhone | (541) 555-0123`}}, {type:"gallery",data:{images:["https://picsum.photos/seed/e/900/600","https://picsum.photos/seed/f/900/600","https://picsum.photos/seed/g/900/600"]}},{type:"footer",data:{text:"¬© 2025 Cedar Grill"}}]})};let site=null,selectedIndex=-1;const history={stack:[],idx:-1,push(s){this.stack=this.stack.slice(0,this.idx+1);this.stack.push(JSON.stringify(s));this.idx++;try{localStorage.setItem(STORAGE.versions,JSON.stringify(this.stack.slice(-20)))}catch(e){}}};const siteRoot=document.getElementById('siteRoot'),statusEl=document.getElementById('status'),frame=document.getElementById('frame');const newSiteBtn=document.getElementById('newSiteBtn'),templatesBtn=document.getElementById('templatesBtn'),exportBtn=document.getElementById('exportBtn'),colorPicker=document.getElementById('colorPicker'),heroTop=document.getElementById('heroTop'),heroBottom=document.getElementById('heroBottom'),fontSelect=document.getElementById('fontSelect'),sectionsList=document.getElementById('sectionsList'),newSectionType=document.getElementById('newSectionType'),addSectionBtn=document.getElementById('addSectionBtn'),templatesDialog=document.getElementById('templatesDialog');document.getElementById('closeTpl').onclick=()=>templatesDialog.close();const inspectorBody=document.getElementById('inspectorBody'),selLabel=document.getElementById('selLabel');const logoUrl=document.getElementById('logoUrl'),logoFile=document.getElementById('logoFile'),logoW=document.getElementById('logoW');const ghUser=document.getElementById('ghUser'),ghRepo=document.getElementById('ghRepo'),ghPublic=document.getElementById('ghPublic'),ghDomain=document.getElementById('ghDomain'),copyYamlBtn=document.getElementById('copyYamlBtn'),copyScriptBtn=document.getElementById('copyScriptBtn');const presets=[{name:'OpCode',color:'#7c5cff',t:'#1c1736',b:'#0e0f1f'},{name:'Emerald',color:'#20c997',t:'#f3fff9',b:'#e9fff5'},{name:'Sunset',color:'#ff7a66',t:'#fff7f5',b:'#fff0ec'},{name:'Slate',color:'#6b7c93',t:'#f5f7fa',b:'#edf2f7'}],presetBar=document.getElementById('themePresets');presets.forEach(p=>{const el=document.createElement('button');el.className='preset';el.textContent=p.name;el.onclick=()=>{site.theme.color=p.color;site.theme.heroTop=p.t;site.theme.heroBottom=p.b;syncThemeInputs();renderSite();save()};presetBar.appendChild(el)});const save=()=>{try{localStorage.setItem(STORAGE.site,JSON.stringify(site))}catch(e){}history.push(site);status(`Saved ${now()}`)},load=()=>{try{const s=JSON.parse(localStorage.getItem(STORAGE.site));if(s)return s}catch(e){}return null};function status(msg){statusEl.textContent=`${site?.name||'(no site)'} ‚Äî ${msg}`}function renderSite(){siteRoot.innerHTML='';if(!site||!site.sections.length){exportBtn.disabled=true;selLabel.textContent='Nothing selected';inspectorBody.innerHTML='<div class="muted">Select a section to edit its content and styles.</div>';return}exportBtn.disabled=false;applyTheme();site.sections.forEach((sec,i)=>{const wrap=document.createElement('div');wrap.className='sec-wrap';wrap.dataset.index=i;const el=renderSection(sec);wrap.appendChild(el);const tools=document.createElement('div');tools.className='sec-tools';tools.innerHTML=`<button title="Edit" data-act="edit">‚úèÔ∏è</button><button title="Duplicate" data-act="dup">‚ßâ</button><button title="Move up" data-act="up">‚Üë</button><button title="Move down" data-act="down">‚Üì</button><button class="danger" title="Delete" data-act="del">üóë</button>`;wrap.appendChild(tools);wrap.addEventListener('click',e=>{selectSection(i);e.stopPropagation()});wrap.addEventListener('dblclick',e=>{const t=e.target;if(t.matches('[data-inline]')){t.contentEditable=true;t.focus();document.execCommand('selectAll',false,null)}});wrap.addEventListener('blur',e=>{const t=e.target;if(t.matches('[data-inline]')){t.contentEditable=false;const key=t.getAttribute('data-inline');sec.data[key]=t.textContent.trim();renderSite();renderInspector();save()}},true);tools.addEventListener('click',e=>{const act=e.target.closest('button')?.dataset.act;if(!act)return;e.stopPropagation();if(act==='edit'){selectSection(i)}if(act==='dup'){site.sections.splice(i+1,0,JSON.parse(JSON.stringify(sec)));selectSection(i+1);renderAll();save()}if(act==='up'){moveSection(i,-1)}if(act==='down'){moveSection(i,1)}if(act==='del'){if(confirm('Delete this section?')){site.sections.splice(i,1);selectedIndex=Math.min(selectedIndex,site.sections.length-1);renderAll();save()}}});if(i===selectedIndex)wrap.classList.add('selected');siteRoot.appendChild(wrap)})}function renderSection(sec){if(sec.type==='hero'){const d=sec.data,s=document.createElement('section');s.className='hero';if(d.bgUrl){const o=Math.max(0,Math.min(.8,Number(d.overlay||0))),bg=(d.bgSize||'cover').replace(/[^a-z]/gi,''),u=String(d.bgUrl).replace(/\\/g,'\\\\').replace(/"/g,'\\"');s.style.background=`linear-gradient(rgba(0,0,0,${o}), rgba(0,0,0,${o})), url("${u}") center/${bg} no-repeat`}const parts=[];if(site.theme.logo){parts.push(`<img class="brand-logo" src="${escapeAttr(String(site.theme.logo))}" alt="logo" style="width:${Number(site.theme.logoW||140)}px">`)}parts.push(`<h1 data-inline="h1">${escapeHTML(d.h1||'Your product, elevated')}</h1>`);parts.push(`<p data-inline="p">${escapeHTML(d.p||'Short supporting copy explaining the value.')}</p>`);parts.push(`<div class="cta">${d.cta1?`<a href="#" data-inline="cta1">${escapeHTML(d.cta1)}</a>`:''}${d.cta2?`<a href="#" style="background:#222;color:#fff" data-inline="cta2">${escapeHTML(d.cta2)}</a>`:''}</div>`);s.innerHTML=parts.join('');return s}if(sec.type==='features'){const wrap=document.createElement('section');wrap.className='features';const lines=parseFeatureLines(sec.data.items);wrap.innerHTML=lines.map(([t,b])=>`<div class="card"><h3>${escapeHTML(t)}</h3><div class="muted" style="color:#555">${escapeHTML(b)}</div></div>`).join('');return wrap}if(sec.type==='gallery'){const wrap=document.createElement('section');wrap.className='gallery';wrap.innerHTML=(sec.data.images||[]).map(u=>`<img loading="lazy" src="${escapeAttr(u)}" alt="">`).join('');return wrap}if(sec.type==='footer'){const wrap=document.createElement('footer');wrap.className='footer';wrap.innerHTML=`<div data-inline="text">${escapeHTML(sec.data.text||'¬© 2025 Your Brand')}</div>`;return wrap}}function parseFeatureLines(txt=''){const s=String(txt).replace(/\r(?!\n)/g,'\n');return s.split(/\r?\n+/).filter(Boolean).map(l=>{const [t,...r]=l.split('|');return [t?.trim()||'Feature',r.join('|').trim()||'Description']})}function applyTheme(){siteRoot.style.setProperty('--color',site.theme.color);siteRoot.style.setProperty('--heroTop',site.theme.heroTop);siteRoot.style.setProperty('--heroBottom',site.theme.heroBottom);siteRoot.style.fontFamily=site.theme.font}function selectSection(i){selectedIndex=i;renderInspector();renderSite();renderSectionsList();save()}function renderSectionsList(){sectionsList.innerHTML='';if(!site)return;site.sections.forEach((sec,i)=>{const row=document.createElement('div');row.className='section-row';row.draggable=true;row.dataset.index=i;row.innerHTML=`<div class="rowtitle">${i+1}. ${sec.type}</div><div class="muted">‚ãÆ‚ãÆ</div>`;row.addEventListener('dragstart',e=>{e.dataTransfer.setData('text/plain',String(i))});row.addEventListener('dragover',e=>{e.preventDefault();row.classList.add('drag-over')});row.addEventListener('dragleave',()=>row.classList.remove('drag-over'));row.addEventListener('drop',e=>{e.preventDefault();row.classList.remove('drag-over');const from=Number(e.dataTransfer.getData('text/plain')),to=i;if(from===to)return;const [s]=site.sections.splice(from,1);site.sections.splice(to,0,s);selectedIndex=to;renderAll();save()});row.onclick=()=>{selectedIndex=i;renderInspector();renderSite()};if(i===selectedIndex)row.style.borderColor='#7c5cff';sectionsList.appendChild(row)})}function moveSection(i,d){const j=i+d;if(j<0||j>=site.sections.length)return;const [s]=site.sections.splice(i,1);site.sections.splice(j,0,s);selectedIndex=j;renderAll();save()}function renderInspector(){inspectorBody.innerHTML='';if(selectedIndex<0){selLabel.textContent='Nothing selected';inspectorBody.innerHTML='<div class="muted">Select a section to edit.</div>';return}const sec=site.sections[selectedIndex];selLabel.textContent=`${selectedIndex+1}. ${sec.type}`;const tpl=document.getElementById(`tpl-${sec.type}-editor`);if(!tpl){inspectorBody.innerHTML='<div class="muted">No editor for this section.</div>';return}const node=tpl.content.cloneNode(true);$$('[data-bind]',node).forEach(input=>{const key=input.getAttribute('data-bind'),v=sec.data[key];input.value=Array.isArray(v)?v.join('\n'):(v??'');input.addEventListener('input',()=>{if(Array.isArray(sec.data[key])){sec.data[key]=input.value.split(/\r?\n+/).filter(Boolean)}else{sec.data[key]=input.value}renderSite();save()})});const bgFile=node.querySelector('[data-bgfile]');if(bgFile){bgFile.addEventListener('change',async e=>{const f=e.target.files?.[0];if(!f)return;const url=await fileToDataURL(f);sec.data.bgUrl=url;renderSite();save()})}inspectorBody.appendChild(node)}function buildExportHTML(model){const esc=s=>String(s).replace(/[&<>]/g,c=>c==='&'?'&amp;':c==='<'?'&lt;':'&gt;'),attr=s=>String(s).replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');const sectionHTML=model.sections.map(sec=>{if(sec.type==='hero'){const d=sec.data||{},ov=Math.max(0,Math.min(.8,Number(d.overlay||0))),bg=d.bgUrl?` style=\"background:linear-gradient(rgba(0,0,0,${ov}), rgba(0,0,0,${ov})), url(\"${attr(d.bgUrl)}\") center/${(d.bgSize||'cover').replace(/[^a-z]/gi,'')} no-repeat\"`:'';const logo=model.theme.logo?`\n  <img class=\"brand-logo\" src=\"${attr(model.theme.logo)}\" alt=\"logo\" style=\"width:${Number(model.theme.logoW||140)}px\">`:'';return `\n<section class=\"hero\"${bg}>${logo}\n  <h1>${esc(d.h1||'')}</h1>\n  <p>${esc(d.p||'')}</p>\n  <div class=\"cta\">${d.cta1?`<a href=\"#\">${esc(d.cta1)}</a>`:''}${d.cta2?`<a href=\"#\" style=\"background:#222;color:#fff\">${esc(d.cta2)}</a>`:''}</div>\n</section>`}if(sec.type==='features')return `\n<section class=\"features\">\n  ${parseFeatureLines(sec.data.items).map(([t,b])=>`<div class=\"card\"><h3>${esc(t)}</h3><div>${esc(b)}</div></div>`).join('\n  ')}\n</section>`;if(sec.type==='gallery')return `\n<section class=\"gallery\">\n  ${(sec.data.images||[]).map(u=>`<img src=\"${attr(u)}\" alt=\"\">`).join('\n  ')}\n</section>`;if(sec.type==='footer')return `\n<footer class=\"footer\">${esc(sec.data.text||'')}</footer>`;return ''}).join('\n\n');const style=`\n:root{--color:${model.theme.color};--heroTop:${model.theme.heroTop};--heroBottom:${model.theme.heroBottom}}\n*{box-sizing:border-box} body{margin:0;font:500 15px/1.5 ${model.theme.font};color:#111}\n.hero{padding:80px 40px;text-align:center;background:linear-gradient(180deg,var(--heroTop),var(--heroBottom));position:relative;overflow:hidden}\n.brand-logo{display:block;margin:0 auto 16px auto;max-width:100%;height:auto;filter:drop-shadow(0 4px 12px rgba(0,0,0,.25))}\n.hero h1{margin:0 0 10px;font-size:42px}\n.hero p{margin:0 auto 22px;max-width:720px;color:#444;font-size:18px}\n.hero .cta{display:flex;gap:10px;justify-content:center}\n.hero .cta a{background:var(--color);color:#fff;padding:12px 16px;border-radius:12px;text-decoration:none}\n.features{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));padding:40px}\n.card{background:#fff;border:1px solid #e9ecf6;border-radius:14px;padding:16px}\n.gallery{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));padding:40px}\n.gallery img{width:100%;height:160px;object-fit:cover;border-radius:12px;border:1px solid #e9ecf6}\n.footer{padding:24px 40px;border-top:1px solid #edf0ff;color:#333;background:#fafbff}`.trim();return `<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><meta name=\"generator\" content=\"OpCode Quantum UI\"><title>${esc(model.name||'Site')}</title><style>${style}</style></head><body>${sectionHTML}</body></html>`}function syncThemeInputs(){colorPicker.value=site.theme.color;heroTop.value=site.theme.heroTop;heroBottom.value=site.theme.heroBottom;fontSelect.value=site.theme.font;logoUrl.value=site.theme.logo||'';logoW.value=site.theme.logoW||140}function renderAll(){renderSite();renderSectionsList();renderInspector()}newSiteBtn.onclick=()=>{site=defaultSite();selectedIndex=-1;renderAll();save()};templatesBtn.onclick=()=>templatesDialog.showModal();$('#templatesDialog').addEventListener('click',e=>{const card=e.target.closest('.template-card');if(!card)return;const key=card.getAttribute('data-template');site=templates[key]();selectedIndex=0;renderAll();save();templatesDialog.close()});addSectionBtn.onclick=()=>{if(!site)site=defaultSite();const type=newSectionType.value,blank=type==='hero'?{h1:'New headline',p:'A short subheading',cta1:'Action',cta2:'Secondary',bgUrl:'',bgSize:'cover',overlay:.25}:type==='features'?{items:'Title | Body'}:type==='gallery'?{images:['https://picsum.photos/800/500']}:{text:'¬© 2025 Your Brand'};site.sections.push({type,data:blank});selectedIndex=site.sections.length-1;renderAll();save()};exportBtn.onclick=()=>{if(!site)return;const html=buildExportHTML(site),blob=new Blob([html],{type:'text/html;charset=utf-8'}),a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=(site.name||'site')+'.html';a.click();setTimeout(()=>URL.revokeObjectURL(a.href),2e3);status('Exported index.html ‚Äî use Deploy helper below')};colorPicker.oninput=e=>{if(!site)return;site.theme.color=e.target.value;applyTheme();save()};heroTop.oninput=e=>{if(!site)return;site.theme.heroTop=e.target.value;applyTheme();save()};heroBottom.oninput=e=>{if(!site)return;site.theme.heroBottom=e.target.value;applyTheme();save()};fontSelect.onchange=e=>{if(!site)return;site.theme.font=e.target.value;applyTheme();save()};logoUrl.addEventListener('input',()=>{site.theme.logo=logoUrl.value||null;renderSite();save()});logoFile.addEventListener('change',async e=>{const f=e.target.files?.[0];if(!f)return;const url=await fileToDataURL(f);site.theme.logo=url;logoUrl.value=url;renderSite();save()});logoW.addEventListener('input',()=>{const v=Math.max(32,Math.min(600,Number(logoW.value||140)));site.theme.logoW=v;renderSite();save()});const pagesYAML=`name: Deploy static site to Pages\non:\n  push:\n    branches: [ main ]\n  workflow_dispatch:\n\npermissions:\n  contents: read\n  pages: write\n  id-token: write\n\nconcurrency:\n  group: "pages"\n  cancel-in-progress: false\n\njobs:\n  deploy:\n    environment:\n      name: github-pages\n      url: \${{ steps.deployment.outputs.page_url }}\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - name: Upload artifact\n        uses: actions/upload-pages-artifact@v3\n        with:\n          path: .\n      - name: Deploy to GitHub Pages\n        id: deployment\n        uses: actions/deploy-pages@v4\n`;function buildPowerShellScript(user,repo,isPublic,domain){const flag=isPublic?"--public":"--private",dom=(domain&&domain.trim().length>0)?`\nif ($Domain -and $Domain.Trim().Length -gt 0) { Set-Content -Path (Join-Path $Work "CNAME") -Value ($Domain.Trim()) -Encoding ASCII }`:'';return `# --- GitHub Pages one-shot deploy (PowerShell) ---\n\n$User    = \"${user||''}\"; if(-not $User){ $User = Read-Host \"GitHub username or org\" }\n$Repo    = \"${repo||'opcode-site'}\"; if(-not $Repo){ $Repo = Read-Host \"Repo name\" }\n$Public  = ${isPublic?'"Y"':'"N"'}\n$Index   = Read-Host \"Full path to your exported index.html\"\n$Domain  = \"${domain||''}\"\n\nif (-not (Test-Path $Index)) { Write-Error \"index.html not found at: $Index\"; exit 1 }\ntry { git --version | Out-Null } catch { Write-Error \"Git not installed or not in PATH.\"; exit 1 }\ntry { gh --version  | Out-Null } catch { Write-Error \"GitHub CLI (gh) not installed or not in PATH.\"; exit 1 }\nif ((gh auth status) -eq $null) { gh auth login }\n\n$Here = Get-Location; $Work = Join-Path $Here $Repo; if(!(Test-Path $Work)){ New-Item -ItemType Directory -Path $Work | Out-Null }; Set-Location $Work\n\ngit init -b main | Out-Null\nCopy-Item -Path $Index -Destination (Join-Path $Work \"index.html\") -Force\n\nNew-Item -ItemType Directory -Force -Path .github\\workflows | Out-Null\n@'\n${pagesYAML}\n'@ | Set-Content .github\\workflows\\pages.yml -Encoding UTF8\n${dom}\n\ngit add .\ngit commit -m \"Initial site\" | Out-Null\n$flag = if (($Public -eq \"\") -or ($Public -match '^[Yy]')) { \"--public\" } else { \"--private\" }\ntry{ gh repo create \"$User/$Repo\" $flag --source=. --remote=origin --push --confirm } catch {\n  git remote add origin https://github.com/$User/$Repo.git\n  git push -u origin main\n}\nWrite-Host \"Repo: https://github.com/$User/$Repo\"\nWrite-Host \"Actions: https://github.com/$User/$Repo/actions\"\nWrite-Host \"Pages: https://github.com/$User/$Repo/settings/pages\"\n`}copyYamlBtn.addEventListener('click',async()=>{try{await navigator.clipboard.writeText(pagesYAML);status('Workflow YAML copied ‚úî')}catch{status('Copy failed ‚Äî select text and copy manually')}});copyScriptBtn.addEventListener('click',async()=>{const script=buildPowerShellScript(ghUser.value.trim(),ghRepo.value.trim(),ghPublic.checked,ghDomain.value.trim());try{await navigator.clipboard.writeText(script);status('PowerShell deploy script copied ‚úî');alert('Copied! Paste into PowerShell.')}catch{status('Copy failed ‚Äî opening a window instead');const w=window.open();if(w){w.document.write(`<pre>${escapeHTML(script)}</pre>`)}}});$$('.viewport-bar .btn').forEach(b=>b.addEventListener('click',()=>{frame.classList.remove('w-desktop','w-tablet','w-mobile');frame.classList.add('w-'+b.dataset.w)}));document.addEventListener('keydown',e=>{const mod=e.metaKey||e.ctrlKey;if(mod&&e.key.toLowerCase()==='s'){e.preventDefault();exportBtn.click()}if(mod&&e.key.toLowerCase()==='z'){e.preventDefault();undo()}if(mod&&(e.key.toLowerCase()==='y'||(e.shiftKey&&e.key.toLowerCase()==='z'))){e.preventDefault();redo()}if(e.key==='Delete'&&selectedIndex>=0){site.sections.splice(selectedIndex,1);selectedIndex=Math.min(selectedIndex,site.sections.length-1);renderAll();save()}});function undo(){if(history.idx<=0)return;history.idx--;site=JSON.parse(history.stack[history.idx]);renderAll();status('Undo')}function redo(){if(history.idx>=history.stack.length-1)return;history.idx++;site=JSON.parse(history.stack[history.idx]);renderAll();status('Redo')}function runTests(){try{const L=parseFeatureLines('A | B\nC|D');console.assert(L.length===2&&L[0][0]==='A'&&L[0][1]==='B');const W=parseFeatureLines('X | Y\r\nZ|W');console.assert(W.length===2&&W[1][0]==='Z');console.assert(escapeHTML('<x&y>')==='&lt;x&amp;y&gt;')}catch(e){}}function boot(){const migrated=migrateStorage();site=load()||defaultSite();history.push(site);renderAll();syncThemeInputs();status(migrated?'Migrated from Site Forge storage ‚Äî Ready':'Ready ‚Äî export then use Deploy helper');runTests()}boot();</script></body></html>
